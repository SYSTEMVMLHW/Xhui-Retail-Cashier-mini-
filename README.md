# 轩慧工作台 - 收银系统

一个简洁美观的 Web 端本地收银系统，支持餐饮和零售两种业务模式

![Version](https://img.shields.io/badge/version-2.0-blue.svg)
![Node](https://img.shields.io/badge/node-%3E%3D10.0.0-brightgreen.svg)


## ✨ 功能特点

### 🎨 现代化界面
- **响应式设计**：完美支持桌面、平板和移动设备
- **流畅动画**：优雅的过渡效果和交互反馈
- **Segoe UI 字体**：现代化的字体系统

### 🛍️ 零售模式
- ✅ 快速商品选择
- ✅ 条码扫码支持（支持条码识别 API 自动填充商品信息）
- ✅ 实时计算找零
- ✅ 多种支付方式
- ✅ 自动打印小票
- ✅ 订单记录查询


### 👥 会员管理系统
- ✅ **会员类型**：预存会员、积分会员
- ✅ **会员充值**：支持充值套餐和赠送
- ✅ **积分系统**：消费积分、积分兑换
- ✅ **余额消费**：会员余额支付
- ✅ **记录查询**：完整的消费记录和积分记录
- ✅ **会员卡打印**：支持打印会员卡和信息

### 📦 商品管理
- ✅ 商品分类管理
- ✅ 商品 CRUD 操作
- ✅ 条码识别自动填充（集成外部 API）
- ✅ 商品图片支持
- ✅ 价格管理

### 📊 数据报表
- ✅ 实时营业统计
- ✅ 支付方式分析
- ✅ 分类销售统计
- ✅ 热销商品排行
- ✅ 订单明细查询
- ✅ Excel 报表导出
- ✅ 日结功能

### ⚙️ 系统设置
- ✅ 店铺信息配置
- ✅ 业务模式切换（零售/餐饮）
- ✅ 支付方式管理
- ✅ 税率设置
- ✅ 桌台和区域管理（餐饮模式）

## 🚀 快速开始

### 系统要求

#### 服务器端
- **Node.js** 版本 10.0.0 或更高
- Windows/Linux/macOS 操作系统

#### 客户端
- 支持现代浏览器（Chrome、Edge、Firefox、Safari）
- 建议使用 Chrome 或 Edge 获得最佳体验

### 安装步骤

1. **安装 Node.js**
   ```bash
   # 访问 https://nodejs.org/ 下载并安装
   # 安装后验证
   node --version
   ```

2. **下载项目**
   ```bash
   # 克隆或下载项目到本地目录
   ```

3. **启动服务器**

   **Windows 用户**：
   ```bash
   # 双击 start.bat
   # 或命令行运行
   node server.js
   ```

   **Linux/macOS 用户**：
   ```bash
   node server.js
   ```

4. **访问系统**
   ```
   http://localhost:8888  或运行客户端
   ```
   ⚠️注意：客户端基于edge webview，需要提前安装

### 首次初始化

首次访问会自动进入初始化向导，按照提示完成配置：

1. **步骤 1：配置数据存储目录**
   - 输入服务器设备上的数据存储路径
   - 例如：`D:\收银数据`
   - 系统会自动创建目录

2. **步骤 2：创建管理员账号**
   - 设置用户名（建议：admin）
   - 设置密码（至少 6 位）
   - 输入店铺名称

3. **步骤 3：选择业务模式**
   - **零售模式**：适用于商场、便利店等


初始化完成后自动跳转到登录页面。

## 📖 使用指南

### 日常操作流程

1. **登录系统**
   - 使用管理员账号登录
   - 进入主工作台

2. **完善配置**
   - 进入"系统设置"
   - 配置店铺信息、支付方式、税率等

3. **添加商品**
   - 进入"商品管理"
   - 创建分类 → 添加商品
   - 支持条码识别自动填充（输入条码后按回车或点击识别）

4. **开始收银**
   - **零售模式**：选择商品 → 调整数量 → 结账

5. **查看报表**
   - 进入"数据报表"
   - 查看营业统计、导出数据

6. **会员管理**
   - 添加会员（预存会员/积分会员）
   - 会员充值
   - 积分操作
   - 查看会员消费记录

### 会员管理详解

#### 会员类型
- **预存会员**：可以充值，支持余额消费
- **积分会员**：仅支持积分累积和兑换

#### 会员操作
- **充值**：支持充值套餐和赠送金额
- **积分操作**：手动增加或扣除积分
- **消费**：会员消费时自动获得积分或使用余额支付
- **查看记录**：查看每个会员的余额变动记录和积分变动记录

## 📁 项目结构

```
收银台/
├── index.html              # 入口路由页面
├── init.html               # 系统初始化页面
├── login.html              # 用户登录页面
├── dashboard.html          # 主工作台页面
├── settings.html           # 系统设置页面
├── server.js               # Node.js Web服务器
├── start.bat               # Windows启动脚本
├── package.json            # 项目配置
├── storage_config.json     # 存储目录配置（自动生成）
├── print_config.json       # 打印配置
├── css/
│   ├── main.css           # 主样式文件
│   ├── pages.css          # 页面统一样式
│   └── responsive.css     # 响应式样式
└── js/
    ├── common.js          # 通用工具函数
    ├── Storage.js         # 数据存储管理
    ├── utils.js           # 工具函数
    ├── init.js            # 初始化逻辑
    ├── app.js             # 应用主逻辑
    ├── products.js        # 商品管理
    ├── retail.js          # 零售收银
    ├── restaurant.js      # 餐饮管理
    ├── members.js         # 会员管理
    ├── reports.js         # 报表统计
    └── settings.js        # 系统设置
```

## 💾 数据存储

### 存储位置
- **默认目录**：项目目录下的 `data` 文件夹
- **自定义目录**：初始化时配置的目录路径
- **配置文件**：`storage_config.json`（自动生成）

### 数据格式
- 所有数据以 JSON 文件格式存储
- 存储在服务器设备上，而非浏览器本地
- 支持自定义存储目录

### 数据文件
```
data/
├── system_config.json      # 系统配置
├── products.json           # 商品数据
├── categories.json         # 分类数据
├── orders.json             # 所有订单
├── today_orders.json       # 今日订单
├── members.json            # 会员数据
├── points_records.json     # 积分记录
├── balance_records.json    # 余额消费记录
├── recharge_records.json   # 充值记录
├── tables.json             # 桌台数据（餐饮）
├── areas.json              # 区域数据（餐饮）
└── payment_methods.json    # 支付方式
```

### 数据备份
- 定期备份整个数据目录
- 或使用"导出 Excel"功能导出订单数据
- 建议每日备份一次

## 🔧 配置说明

### 条码识别 API
系统集成了条码识别 API，支持自动填充商品信息：
- API 地址：`https://www.mxnzp.com/api/barcode/goods/details`
- 输入条码后按回车或点击"识别"按钮
- 自动填充商品名称和价格

### 打印功能
- 支持小票打印
- 支持会员卡打印
- 打印配置保存在 `print_config.json`
- 需要配置打印机

### 自定义存储目录
修改 `storage_config.json`：
```json
{
  "storageDir": "D:\\收银数据"
}
```

## ⚠️ 注意事项

1. **服务器必须持续运行**，数据存储在服务器设备上
2. **定期备份数据**，避免数据丢失
3. **不要删除数据目录**，会导致数据丢失
4. **切换业务模式后需刷新页面**
5. **日结操作会清空今日订单**，建议先导出数据
6. **不要在运行中删除数据目录**
7. **首次使用必须完成初始化配置**
8. **打印尺寸异常请打开记事本修改页面配置，58mm小票建议配置：边距全部设为0，字体：5**
## 🐛 故障排除

### 服务器启动失败

**问题**：端口被占用（EADDRINUSE）
```bash
# 解决：修改 server.js 中的 PORT 值
const PORT = 8888;  # 改为其他端口，如 8889
```

### 无法访问系统

**检查清单**：
- ✅ 服务器是否已启动（查看命令行输出）
- ✅ 访问地址是否正确（http://localhost:8888）
- ✅ 防火墙是否阻止端口
- ✅ 浏览器控制台是否有错误（按 F12）

### 初始化失败

**问题**：存储目录配置失败
- 检查目录路径是否正确
- 确认有写入权限
- 查看命令行错误信息

### 数据丢失

**预防措施**：
- 定期备份数据目录
- 使用导出功能保存重要数据
- 不要删除数据目录

### 页面显示异常

**检查清单**：
- 浏览器控制台错误（F12）
- CSS 文件是否加载
- JavaScript 错误信息
- 浏览器兼容性问题

### 条码识别失败

**可能原因**：
- 网络连接问题
- API 服务暂时不可用
- 条码格式不支持

## 🔐 安全说明

- 所有数据存储在本地服务器，不会上传到任何第三方服务器
- 支持设置管理员密码
- 建议在局域网内使用
- 如需外网访问，请配置防火墙和安全策略



**轩慧工作台 v2.0** - 让收银更简单！

![轩慧工作台](https://img.shields.io/badge/轩慧工作台-v2.0-blue)

[黯の小站](https://www.an25.asia)
